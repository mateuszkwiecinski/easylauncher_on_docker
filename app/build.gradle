import java.awt.Font
import java.awt.GraphicsEnvironment

tasks.register("loadFont", TestTask) {
    fontFile = rootProject.file("Roboto-Regular.ttf")
}

abstract class TestTask extends DefaultTask {

    @InputFile
    abstract File fontFile

    @TaskAction
    def execute() {
        def ge = GraphicsEnvironment.getLocalGraphicsEnvironment()
        if (ge) {
            def beforeFonts = ge.getAllFonts()
            println("before(size)=${beforeFonts?.size()}")
        } else {
            println("WTF!? ge=$ge")
        }
        def font = Font.createFont(Font.TRUETYPE_FONT, fontFile)
        println("Loaded font=${fontFile}, font=$font")

        if (ge) {
            def afterFonts = ge.getAllFonts()
            println("after(size)=${afterFonts?.size()}")
        }
    }
}