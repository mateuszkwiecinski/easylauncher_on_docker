import java.awt.Font
import java.awt.GraphicsEnvironment

tasks.register("loadFont", TestTask) {
    fontFile = rootProject.file("Roboto-Regular.ttf")
}

abstract class TestTask extends DefaultTask {

    @InputFile
    abstract File fontFile

    @TaskAction
    def execute() {
        GraphicsEnvironment.getLocalGraphicsEnvironment() // ???
        def beforeFonts = GraphicsEnvironment.getLocalGraphicsEnvironment()?.getAvailableFontFamilyNames()
        println("before(size)=${beforeFonts?.size()}")
        println("before=${beforeFonts}")
        def stream = new FileInputStream(fontFile)
        def font = Font.createFont(Font.TRUETYPE_FONT, stream)
        stream.close()
        println("Loaded font=${fontFile}, font=$font")
        def afterFonts = GraphicsEnvironment.getLocalGraphicsEnvironment()?.getAvailableFontFamilyNames()
        println("after(size)=${afterFonts?.size()}")
        println("after=${afterFonts}")
    }
}